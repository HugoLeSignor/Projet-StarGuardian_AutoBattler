<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>{% block title %}Welcome!{% endblock %}</title>
        <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 128 128%22><text y=%221.2em%22 font-size=%2296%22>⚫️</text><text y=%221.3em%22 x=%220.2em%22 font-size=%2276%22 fill=%22%23fff%22>sf</text></svg>">
        {% block stylesheets %}
            {{ encore_entry_link_tags('app') }}
        {% endblock %}

        {% block javascripts %}
            {{ encore_entry_script_tags('app') }}
            
        {% endblock %}
    </head>
    <body>
        {% if app.user %}
        <div class="topbar">
            <div class="topbar__left">
                <div class="topbar__user" data-profile-toggle>
                    {% if app.user.profileImage %}
                        <img class="topbar__avatar" src="/uploads/avatars/{{ app.user.profileImage }}" alt="Avatar">
                    {% else %}
                        <i class="fas fa-user"></i>
                    {% endif %}
                    <span class="topbar__username">{{ app.user.username }}</span>
                </div>
                {% if is_granted('ROLE_ADMIN') %}
                <a href="{{ path('app_admin') }}" class="topbar__icon" title="Administration">
                    <i class="fas fa-crown"></i>
                </a>
                {% endif %}
                <div class="topbar__icon" data-friends-toggle title="Compagnons">
                    <i class="fas fa-user-friends"></i>
                    <span class="topbar__friends-badge" data-friends-badge style="display:none;">0</span>
                </div>
            </div>

            <a href="{{ path('app_teams') }}" class="topbar__play">
                <i class="fas fa-fire"></i>
                Jouer
            </a>

            <div class="topbar__right">
                <a href="{{ path('app_logout') }}" class="topbar__logout">
                    <i class="fas fa-sign-out-alt"></i>
                    D&eacute;connexion
                </a>
            </div>
        </div>

        <div class="profile-popup" data-profile-popup style="display:none;">
            <div class="profile-popup__header">
                <h2 class="profile-popup__title">
                    <i class="fas fa-scroll"></i>
                    Profil du Guerrier
                </h2>
                <button class="profile-popup__close" data-profile-close>
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="profile-popup__content" data-profile-content>
                <div class="profile-popup__loading">
                    <i class="fas fa-spinner fa-spin"></i> Chargement...
                </div>
            </div>
        </div>
        <div class="profile-popup__backdrop" data-profile-backdrop style="display:none;"></div>

        <div class="friends-panel" data-friends-panel style="display:none;">
            <div class="friends-panel__header">
                <h2 class="friends-panel__title">
                    <i class="fas fa-user-friends"></i>
                    Compagnons
                </h2>
                <button class="friends-panel__close" data-friends-close>
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="friends-panel__tabs">
                <button class="friends-panel__tab friends-panel__tab--active" data-friends-tab="friends">
                    <i class="fas fa-users"></i> Amis
                </button>
                <button class="friends-panel__tab" data-friends-tab="requests">
                    <i class="fas fa-envelope"></i> Demandes
                    <span class="friends-panel__tab-badge" data-requests-badge style="display:none;">0</span>
                </button>
                <button class="friends-panel__tab" data-friends-tab="search">
                    <i class="fas fa-search"></i> Chercher
                </button>
            </div>

            <div class="friends-panel__content">
                <div class="friends-panel__tab-content friends-panel__tab-content--active" data-tab-content="friends">
                    <div class="friends-panel__loading">
                        <i class="fas fa-spinner fa-spin"></i> Chargement...
                    </div>
                </div>

                <div class="friends-panel__tab-content" data-tab-content="requests" style="display:none;">
                    <div class="friends-panel__loading">
                        <i class="fas fa-spinner fa-spin"></i> Chargement...
                    </div>
                </div>

                <div class="friends-panel__tab-content" data-tab-content="search" style="display:none;">
                    <div class="friends-search">
                        <input type="text" class="friends-search__input" data-friends-search-input
                               placeholder="Rechercher un guerrier...">
                    </div>
                    <div class="friends-search__results" data-friends-search-results></div>
                </div>
            </div>

            <div class="friends-panel__conversation" data-friends-conversation style="display:none;">
                <div class="friends-conversation__header">
                    <button class="friends-conversation__back" data-conversation-back>
                        <i class="fas fa-arrow-left"></i>
                    </button>
                    <span class="friends-conversation__name" data-conversation-name></span>
                </div>
                <div class="friends-conversation__messages" data-conversation-messages></div>
                <div class="friends-conversation__input-area">
                    <input type="text" class="friends-conversation__input" data-conversation-input
                           placeholder="Ecrire un message..." maxlength="1000">
                    <button class="friends-conversation__send" data-conversation-send>
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
        <div class="friends-panel__backdrop" data-friends-backdrop style="display:none;"></div>
        {% endif %}
        {% block header %}{% endblock %}
        <main>
            {% for message in app.flashes('success') %}
                <div class="flash-message flash-message--success">
                    <i class="fas fa-check"></i> {{ message }}
                </div>
            {% endfor %}
            {% for message in app.flashes('error') %}
                <div class="flash-message flash-message--error">
                    <i class="fas fa-exclamation-triangle"></i> {{ message }}
                </div>
            {% endfor %}
            {% block body %}{% endblock %}
        </main>
        <footer>
            <p>© Tous droit réservés au site</p>
        </footer>
    </body>
</html>
